<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Toureiro vs Boi — Carne e Mecânica</title>
<style>
  :root{
    --bg-1:#0f1724;
    --bg-2:#12233a;
    --accent:#e11d48;
    --muted:#cbd5e1;
    --arena-bg:#0b322a;
    --hud-bg: rgba(0,0,0,0.25);
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial; background: radial-gradient(1200px 600px at 10% 10%, rgba(255,255,255,0.02), transparent), linear-gradient(180deg,var(--bg-1),var(--bg-2)); color:var(--muted);}
  
  .screen{
    position:fixed; inset:0; display:flex; align-items:center; justify-content:center; z-index:100;
  }
  #startScreen{flex-direction:column; gap:18px}
  .title{
    font-size: clamp(28px,6vw,56px);
    color: white;
    letter-spacing:4px;
    text-shadow:0 6px 30px rgba(0,0,0,0.6);
  }
  .btn {
    background: linear-gradient(180deg,var(--accent),#a50f33);
    color:white; border:none; padding:14px 30px; border-radius:14px; font-size:18px; cursor:pointer; box-shadow:0 8px 30px rgba(0,0,0,0.5);
  }
  .sub{color: #9fb3c8; font-size:14px; opacity:0.95}

  
  #arena{
    width:100vw; height:100vh; position:relative; overflow:hidden;
    display:none;
    perspective:1000px;
  }
  
  .ground{
    position:absolute; inset:0;
    background:
      repeating-linear-gradient(0deg, rgba(255,255,255,0.02) 0 1px, transparent 1px 4px),
      linear-gradient(180deg,#063a2f,#0b322a 60%, #04221b 100%);
    filter:contrast(1.05) saturate(0.9);
  }
  .vignette{position:absolute; inset:0; pointer-events:none; background: radial-gradient(ellipse at center, rgba(0,0,0,0) 35%, rgba(0,0,0,0.45) 100%);}

  
  #hud{
    position: absolute; top:14px; left:14px; z-index:60;
    background:var(--hud-bg); padding:8px 12px; border-radius:10px; display:flex; gap:12px; align-items:center; backdrop-filter: blur(6px);
  }
  #score{font-weight:700; color:#fff; font-size:18px}
  #speedLevel{font-size:13px; color:#dbeafe}

  
  #player{
    position:absolute; width:48px; height:92px; bottom:14px; left:50%; transform:translateX(-50%);
    z-index:40; display:flex; align-items:flex-end; justify-content:center; transition:transform .08s linear;
  }
  
  #player .body{
    width:48px; height:64px; background:linear-gradient(180deg,#ff5858,#d32f2f); border-radius:8px; position:relative; box-shadow:0 8px 18px rgba(0,0,0,0.45);
  }
  
  #player .head{
    position:absolute; top:-18px; left: 50%; transform: translateX(-50%); width:28px; height:28px; background:#ffd6c0; border-radius:50%; box-shadow: inset 0 -4px 6px rgba(0,0,0,0.08);
  }
  
  #cape{
    position:absolute; width:34px; height:56px; bottom:26px; z-index:35; pointer-events:none;
    transform-origin: left top;
    background: linear-gradient(160deg,#ff2d55,#b91c3a);
    border-radius:6px;
    box-shadow:0 8px 20px rgba(185,28,45,0.25);
    mix-blend-mode: normal;
  }
  
  .cape-wave {
    animation: cape-wave 600ms ease-in-out infinite;
  }
  @keyframes cape-wave {
    0%{ transform: translateY(0) rotate(-10deg) }
    50%{ transform: translateY(-6px) rotate(-4deg) }
    100%{ transform: translateY(0) rotate(-10deg) }
  }

  
  #bull{
    position:absolute; width:68px; height:64px; top: -120px; left:50%;
    transform:translateX(-50%); z-index:30; transition:transform .08s linear;
    filter: drop-shadow(0 12px 10px rgba(0,0,0,0.35));
  }
  .bull-body{
    position:absolute; inset:0; background:linear-gradient(180deg,#3d2b1f,#1f1410); border-radius:12px; clip-path: polygon(10% 10%, 90% 10%, 100% 60%, 90% 90%, 10% 90%, 0% 60%);
  }
  .bull-horn{
    position:absolute; width:18px; height:10px; background:#fff; border-radius:6px; top:6px; left:6px; transform:rotate(-20deg);
  }
  .bull-horn.right{left:auto; right:6px; transform:rotate(20deg)}
  .bull-shadow{position:absolute; left:50%; transform:translateX(-50%); bottom:-6px; width:90px; height:14px; background: radial-gradient(ellipse at center, rgba(0,0,0,0.45), rgba(0,0,0,0.1)); border-radius:50%; opacity:0.9; z-index:5}

  
  #controls{
    position:absolute; bottom:18px; left:50%; transform:translateX(-50%); display:flex; gap:14px; z-index:60;
  }
  .control-btn{
    width:68px; height:52px; border-radius:12px; border:none; font-size:22px; background:rgba(255,255,255,0.06); color:var(--muted); backdrop-filter: blur(6px);
    box-shadow:0 6px 18px rgba(0,0,0,0.45); display:flex; align-items:center; justify-content:center; user-select:none;
  }
  .control-btn:active{ transform: translateY(2px) scale(.99) }

  
  .particle{
    position:absolute; width:8px; height:8px; border-radius:3px; pointer-events:none;
    opacity:1; transform: translate3d(0,0,0);
  }

  
  #overlay{
    position:fixed; inset:0; display:none; align-items:center; justify-content:center; z-index:200;
    background: linear-gradient(180deg, rgba(0,0,0,0.55), rgba(0,0,0,0.8));
  }
  .card{
    background:linear-gradient(180deg,#0b1220,#08111a); color:white; padding:28px 34px; border-radius:16px; text-align:center; box-shadow:0 20px 50px rgba(0,0,0,0.6);
  }
  .card h2{margin:0 0 12px; font-size:28px}
  .card .big{font-size:22px; color:#a5f3fc; margin-bottom:16px}
  .card button{padding:12px 22px; font-size:16px; border-radius:10px; border:none; background:var(--accent); color:white; cursor:pointer}

  
  @media (max-width:420px){
    #player{width:40px;height:78px}
    #controls .control-btn{width:56px;height:48px}
    #cape{width:30px;height:52px}
    #bull{width:56px;height:54px}
  }
</style>
</head>
<body>


<div id="startScreen" class="screen" style="display:flex;">
  <div id="startCard" style="display:flex;flex-direction:column;align-items:center;gap:12px">
    <div class="title">TOUREIRO VS BOI</div>
    <div class="sub">Toque em JOGAR para começar — controles na parte inferior</div>
    <button id="btnStart" class="btn">JOGAR</button>
  </div>
</div>


<div id="arena" aria-hidden="true">
  <div class="ground"></div>
  <div class="vignette"></div>

  
  <div id="hud">
    <div id="score">Pontos: <span id="pts">0</span></div>
    <div id="speedLevel">Velocidade: <span id="spd">1</span></div>
  </div>

  
  <div id="player" aria-hidden="false">
    <div class="body"></div>
    <div class="head"></div>
  </div>
  <div id="cape" class="cape-wave"></div>

  
  <div id="bull">
    <div class="bull-body"></div>
    <div class="bull-horn"></div>
    <div class="bull-horn right"></div>
    <div class="bull-shadow"></div>
  </div>

  
  <div id="controls">
    <button id="btnLeft" class="control-btn">◀</button>
    <button id="btnToggle" class="control-btn">⇄</button>
    <button id="btnRight" class="control-btn">▶</button>
  </div>
</div>


<div id="overlay" role="dialog" aria-modal="true">
  <div class="card">
    <h2>Game Over</h2>
    <div class="big">Pontos: <span id="finalPts">0</span></div>
    <button id="btnRestart">Recomeçar</button>
  </div>
</div>

<script>



const startScreen = document.getElementById('startScreen');
const btnStart = document.getElementById('btnStart');
const arena = document.getElementById('arena');
const player = document.getElementById('player');
const cape = document.getElementById('cape');
const bull = document.getElementById('bull');
const btnLeft = document.getElementById('btnLeft');
const btnRight = document.getElementById('btnRight');
const btnToggle = document.getElementById('btnToggle');
const ptsEl = document.getElementById('pts');
const spdEl = document.getElementById('spd');
const overlay = document.getElementById('overlay');
const finalPts = document.getElementById('finalPts');
const btnRestart = document.getElementById('btnRestart');

let score = 0;
let speedLevel = 1;
let gameRunning = false;
let lastTime = 0;
let playerX = window.innerWidth/2;
let playerW = 48;
let capeSide = 'right';
let capeOffset = 70; 
let bullX = Math.random() * (window.innerWidth - 80);
let bullY = -120;
let bullSpeed = 2.8; 
let moveDir = 0; 
let keys = {};
let holdPointer = null;


const AudioCtx = window.AudioContext || window.webkitAudioContext;
let audioCtx = null;
function playTone(freq, type='sine', duration=0.12, gain=0.08){
  if(!audioCtx) audioCtx = new AudioCtx();
  const o = audioCtx.createOscillator();
  const g = audioCtx.createGain();
  o.type = type;
  o.frequency.setValueAtTime(freq, audioCtx.currentTime);
  g.gain.setValueAtTime(gain, audioCtx.currentTime);
  o.connect(g); g.connect(audioCtx.destination);
  o.start();
  o.stop(audioCtx.currentTime + duration);
}


function clamp(v,a,b){ return Math.max(a, Math.min(b, v)); }
function rand(min,max){ return Math.random()*(max-min)+min; }


function positionPlayer(x){
  playerX = clamp(x, 10, window.innerWidth - playerW - 10);
  player.style.left = `${playerX}px`;
  
  if(capeSide === 'right'){
    cape.style.left = `${playerX + capeOffset}px`;
    cape.style.transform = 'rotate(-10deg)';
  } else {
    
    const cW = cape.offsetWidth || 34;
    cape.style.left = `${playerX - capeOffset - cW/4}px`;
    cape.style.transform = 'rotate(8deg)';
  }
}

function resetBull(){
  bullX = rand(20, window.innerWidth - 80);
  bullY = -rand(80,240);
  bull.style.left = `${bullX}px`;
  bull.style.top = `${bullY}px`;
}


function spawnParticles(x,y, color='#ff6b6b'){
  const count = 10 + Math.floor(rand(0,8));
  for(let i=0;i<count;i++){
    const p = document.createElement('div');
    p.className='particle';
    p.style.left = `${x}px`;
    p.style.top = `${y}px`;
    p.style.background = color;
    arena.appendChild(p);

    
    const vx = rand(-2.6,2.6);
    const vy = rand(-6,-1.5);
    const life = rand(700,1200);

  
    const start = performance.now();
    function tick(t){
      const dt = t - start;
      const f = dt / life;
      if(f >= 1){
        p.remove(); return;
      }
      p.style.transform = `translate(${vx * dt/16}px, ${vy * dt/16 + 0.5 * 0.08 * (dt/16)**2}px)`;
      p.style.opacity = `${1 - f}`;
      requestAnimationFrame(tick);
    }
    requestAnimationFrame(tick);
  }
}


function rect(el){
  return el.getBoundingClientRect();
}
function hasCollision(a,b){
  const A = a.getBoundingClientRect();
  const B = b.getBoundingClientRect();
  return !(A.right < B.left || A.left > B.right || A.bottom < B.top || A.top > B.bottom);
}


function gameLoopFrame(t){
  if(!gameRunning) return;
  const dt = lastTime ? (t - lastTime) : 16;
  lastTime = t;

  
  if(moveDir !== 0){
    const px = playerX + moveDir * (dt/16) * 10 * (1 + speedLevel*0.06);
    positionPlayer(px);
  }

  
  bullY += bullSpeed * (dt/16) * (1 + speedLevel*0.08);
  bull.style.top = `${bullY}px`;
  bull.style.left = `${bullX}px`;

  
  const bullRect = bull.getBoundingClientRect();
  const depth = clamp((bullY + bullRect.height)/window.innerHeight, 0, 1);
  const shadow = bull.querySelector('.bull-shadow');
  if(shadow) shadow.style.transform = `translateX(-50%) scale(${0.6 + depth*1.2})`;


  if(hasCollision(bull, cape)){
    
    score += 1;
    ptsEl.textContent = score;
  
    if(score % 4 === 0) { speedLevel += 1; spdEl.textContent = speedLevel; bullSpeed += 0.4; }
    
    playTone(880, 'triangle', 0.12, 0.05);
    spawnParticles(bullX + 20, bullY + 20, '#ff3b61');

    
    bullY = -rand(80,200);
    bullX = rand(20, window.innerWidth - 80);
    bull.style.left = `${bullX}px`;
    bull.style.top = `${bullY}px`;
  }

  
  if(hasCollision(bull, player)){
    
    playTone(220,'sawtooth',0.5,0.12);
    if(navigator.vibrate) navigator.vibrate(80);
    endGame();
    return;
  }

  
  if(bullY > window.innerHeight + 80){
    bullY = -rand(80,220);
    bullX = rand(20, window.innerWidth - 80);
    bull.style.left = `${bullX}px`;
    bull.style.top = `${bullY}px`;
  }

  requestAnimationFrame(gameLoopFrame);
}


function startGame(){
  
  score = 0; speedLevel = 1; spdEl.textContent = speedLevel; ptsEl.textContent = score;
  bullSpeed = 2.8;
  resetBull();
  positionPlayer(window.innerWidth/2);
  overlay.style.display = 'none';
  startScreen.style.display = 'none';
  arena.style.display = 'block';
  gameRunning = true;
  lastTime = 0;
  
  playTone(600,'sine',0.06,0.06);
  requestAnimationFrame(gameLoopFrame);
}
function endGame(){
  gameRunning = false;
  overlay.style.display = 'flex';
  finalPts.textContent = score;
  
  spawnParticles(playerX + 20, window.innerHeight - 80, '#fff3');
}




window.addEventListener('keydown', (e)=>{
  if(e.key === 'ArrowLeft') { moveDir = -1; }
  if(e.key === 'ArrowRight') { moveDir = 1; }
  if(e.key === ' '){ toggleCape(); }
});
window.addEventListener('keyup', (e)=>{
  if(e.key === 'ArrowLeft' && moveDir === -1) moveDir = 0;
  if(e.key === 'ArrowRight' && moveDir === 1) moveDir = 0;
});


btnLeft.addEventListener('pointerdown', (e)=>{ e.preventDefault(); moveDir = -1; });
btnLeft.addEventListener('pointerup', ()=>{ moveDir = 0; });
btnLeft.addEventListener('pointercancel', ()=>{ moveDir = 0; });
btnRight.addEventListener('pointerdown', (e)=>{ e.preventDefault(); moveDir = 1; });
btnRight.addEventListener('pointerup', ()=>{ moveDir = 0; });
btnRight.addEventListener('pointercancel', ()=>{ moveDir = 0; });


btnToggle.addEventListener('click', toggleCape);
function toggleCape(){
  if(capeSide === 'right'){
    capeSide = 'left';
    
    cape.style.left = `${playerX - capeOffset - (cape.offsetWidth||34)/4}px`;
    cape.style.transform = 'rotate(8deg)';
  } else {
    capeSide = 'right';
    cape.style.left = `${playerX + capeOffset}px`;
    cape.style.transform = 'rotate(-10deg)';
  }
  playTone(440,'square',0.08,0.04);
}


let activePointer = null;
arena.addEventListener('pointerdown', (e)=>{
  
  if(e.target.closest('#controls')) return;
  activePointer = e.pointerId;
  arena.setPointerCapture(activePointer);
  // track pointer moves to set playerX (drag)  
  const px = e.clientX - playerW/2 - 6;
  positionPlayer(px);
});
arena.addEventListener('pointermove', (e)=>{
  if(activePointer !== e.pointerId) return;
  const px = e.clientX - playerW/2 - 6;
  positionPlayer(px);
});
arena.addEventListener('pointerup', (e)=>{
  if(activePointer !== e.pointerId) return;
  arena.releasePointerCapture(activePointer);
  activePointer = null;
});


btnStart.addEventListener('click', ()=>{ startGame(); });
btnRestart.addEventListener('click', ()=>{ overlay.style.display='none'; startGame(); });


window.addEventListener('resize', ()=>{
  playerW = player.offsetWidth;
  positionPlayer(playerX);
});


positionPlayer(playerX);
resetBull();


setInterval(()=>{
  if(!gameRunning && startScreen.style.display === 'flex'){
    
    btnStart.animate([{transform:'translateY(0)'},{transform:'translateY(-6px)'},{transform:'translateY(0)'}],{duration:1400,iterations:1});
  }
}, 1600);

</script>
</body>
      </html>
